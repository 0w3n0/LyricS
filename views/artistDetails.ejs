<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Détails de la musique</title>
    <link rel="stylesheet" href="/css/h.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>

<body>

    <%- include('header.ejs') %>

        <main id="TDetails">

            <!-- <h1>Détails de la musique</h1> -->
            <!-- Affichez les détails de la musique ici -->

            <div class="track-image-details">
                <img src="<%= ArtistInfos.images[0].url %>" alt="<%= ArtistInfos.name %>">
                <h2>
                    <%= ArtistInfos.name %>
                </h2>
            </div>
            <style>
                .track-image-details {
                    position: relative;
                    /* width: 500px;
                  height: 300px; */
                    background: no-repeat center center;
                    background-image: url('<%= ArtistInfos.images[0].url %>');
                    background-size: cover;
                }

                .track-image-details::after {
                    content: "";
                    position: absolute;
                    width: 100%;
                    height: 100%;
                    backdrop-filter: blur(10px);
                    pointer-events: none;
                }
            </style>
            <h2>Musiques les plus écoutées</h2>
            <div class="tracks-container">
                
                <% TopTracks.tracks.forEach(track=> { %>
                    <div class="track">
                        <div class="track-image">
                            <img src="<%= track.album.images[0].url %>" alt="<%= track.name %>">
                        </div>
                        <div class="track-info">
                            <a href="/track/<%= track.id %>">
                                <h2>
                                    <%= track.name %>
                                </h2>
                            </a>
                            <% if (track.artists.length> 1) { %>
                                <% track.artists.forEach((artist, index)=> { %>
                                    <% if (index===1) { %>
                                        ft. <a href="/artist/<%= artist.id %>"><%= artist.name %></a>
                                            <% } else if (index===2) { %>
                                                , <a href="/artist/<%= artist.id %>"><%= artist.name %></a>
                                                    <% } else if (index===0) { %>
                                                        <p>
                                                            <a href="/artist/<%= artist.id %>"><%= artist.name %></a>
                                                                <% } %>
                                                                    <% }); %>
                                                                        - <%= track.album.name %>
                                                        </p>
                                                        <% } else { %>
                                                            <p>
                                                                <a href="/artist/<%= track.artists[0].id %>"><%= track.artists[0].name %></a> - <%= track.album.name %>
                                                            </p>
                                                            <% } %>
                        </div>
                        <div class="track-duration">
                            <% const durationMs=track.duration_ms; const durationSeconds=Math.floor(durationMs / 1000);
                                const minutes=Math.floor(durationSeconds / 60); const seconds=durationSeconds % 60; %>
                                <%= `${minutes}:${seconds.toString().padStart(2, '0' )}` %> <!-- Format MM:SS -->
                        </div>
                    </div>
                    <% }); %>
            </div>

            <div class="recommended-artists">
                <h2>Recommandations</h2>
                <div class="artists-container-home">
                    <% recommendationArtists.artists.forEach(artist=> { %>
                        <div class="artist-home">
                            <div class="artist-image">
                                <% if(artist.images.length> 0) { %>
                                    <img src="<%= artist.images[0].url %>" alt="<%= artist.name %>">
                                    <% } else { %>
                                        <img src="../images/user-defaut-pp.jpg" alt="<%= artist.name %>">
                                        <% } %>
                            </div>
                            <div>
                                <h2 class="artist-name">
                                    <a href="/artist/<%= artist.id %>"><%= artist.name %></a>
                                </h2>
                            </div>
                        </div>
                        <% }); %>
                </div>
            </div>
            </div>
            <!-- Ajoutez un lien vers la musique sur Spotify -->
        </main>
</body>

</html>